<%- include('header') %>

<!-- PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸ -->
<div id="pwa-prompt" class="pwa-prompt" style="display: none;">
    <div class="pwa-content">
        <span>ğŸ“± WonGram Shopì„ ì•±ìœ¼ë¡œ ì„¤ì¹˜í•˜ì„¸ìš”!</span>
        <button id="pwa-install" class="btn btn-primary">ì„¤ì¹˜</button>
        <button id="pwa-dismiss" class="btn btn-secondary">ë‹«ê¸°</button>
    </div>
</div>

<div class="container">
    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <div class="hero-text">
                <h1>ğŸ›ï¸ WonGram Shop</h1>
                <h2>AI ê¸°ë°˜ ì¿ íŒ¡ ë¦¬ë·° & í…ŒíŠ¸ë¦¬ìŠ¤ ê²Œì„</h2>
                <p>ğŸ¤– <strong>Gemini AI</strong>ê°€ ë„ì™€ì£¼ëŠ” ìŠ¤ë§ˆíŠ¸í•œ ì‡¼í•‘ ê°€ì´ë“œì™€ ì¬ë¯¸ìˆëŠ” ê²Œì„ì„ í•œ ê³³ì—ì„œ!</p>
                <div class="hero-features">
                    <div class="feature">
                        <span class="feature-icon">ğŸ”</span>
                        <span>AI ë¦¬ë·° ë¶„ì„</span>
                    </div>
                    <div class="feature">
                        <span class="feature-icon">ğŸ®</span>
                        <span>í…ŒíŠ¸ë¦¬ìŠ¤ ê²Œì„</span>
                    </div>
                    <div class="feature">
                        <span class="feature-icon">ğŸ“±</span>
                        <span>PWA ì§€ì›</span>
                    </div>
                </div>
                <div class="hero-buttons">
                    <a href="/reviews" class="btn btn-primary btn-large">
                        <span class="btn-icon">ğŸ“–</span>
                        ë¦¬ë·° ë³´ê¸°
                    </a>
                    <a href="/game/tetris" class="btn btn-secondary btn-large">
                        <span class="btn-icon">ğŸ®</span>
                        í…ŒíŠ¸ë¦¬ìŠ¤ í”Œë ˆì´
                    </a>
                </div>
            </div>
            <div class="hero-visual">
                <div class="floating-elements">
                    <div class="float-item float-1">ğŸ›’</div>
                    <div class="float-item float-2">â­</div>
                    <div class="float-item float-3">ğŸ¯</div>
                    <div class="float-item float-4">ğŸ’¡</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Quick Stats -->
    <section class="stats-section">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="total-reviews">0</div>
                <div class="stat-label">ì´ ë¦¬ë·°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="total-games">1,247</div>
                <div class="stat-label">ê²Œì„ í”Œë ˆì´</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">âš¡</div>
                <div class="stat-label">AI ë¶„ì„</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">ğŸ“±</div>
                <div class="stat-label">PWA ì§€ì›</div>
            </div>
        </div>
    </section>

    <!-- Featured Game Section -->
    <section class="game-spotlight">
        <div class="spotlight-content">
            <div class="spotlight-text">
                <h2>ğŸ® í…ŒíŠ¸ë¦¬ìŠ¤ ë§ˆìŠ¤í„°ì— ë„ì „í•˜ì„¸ìš”!</h2>
                <p>í´ë˜ì‹í•œ í…ŒíŠ¸ë¦¬ìŠ¤ ê²Œì„ì„ ëª¨ë˜í•œ ë””ìì¸ìœ¼ë¡œ ì¦ê²¨ë³´ì„¸ìš”. ëª¨ë°”ì¼ê³¼ ë°ìŠ¤í¬í†± ëª¨ë‘ ì§€ì›!</p>
                <div class="game-features">
                    <div class="game-feature">
                        <span class="feature-check">âœ“</span>
                        <span>60FPS ë¶€ë“œëŸ¬ìš´ ê²Œì„í”Œë ˆì´</span>
                    </div>
                    <div class="game-feature">
                        <span class="feature-check">âœ“</span>
                        <span>í„°ì¹˜ & í‚¤ë³´ë“œ ì»¨íŠ¸ë¡¤</span>
                    </div>
                    <div class="game-feature">
                        <span class="feature-check">âœ“</span>
                        <span>ì‹¤ì‹œê°„ ë­í‚¹ ì‹œìŠ¤í…œ</span>
                    </div>
                    <div class="game-feature">
                        <span class="feature-check">âœ“</span>
                        <span>ì˜¤í”„ë¼ì¸ í”Œë ˆì´ ê°€ëŠ¥</span>
                    </div>
                </div>
                <a href="/game/tetris" class="btn btn-game">
                    <span class="btn-icon">ğŸ¯</span>
                    ì§€ê¸ˆ í”Œë ˆì´í•˜ê¸°
                </a>
            </div>
            <div class="spotlight-preview">
                <div class="game-preview-container">
                    <div class="tetris-mini-board">
                        <!-- Row 1 -->
                        <div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div>
                        <!-- Row 2 -->
                        <div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div>
                        <!-- Row 3 -->
                        <div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div>
                        <!-- Row 4 -->
                        <div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div><div class="mini-block"></div>
                        <!-- Row 5 -->
                        <div class="mini-block red"></div><div class="mini-block"></div><div class="mini-block blue"></div><div class="mini-block"></div><div class="mini-block green"></div><div class="mini-block"></div>
                        <!-- Row 6 -->
                        <div class="mini-block red"></div><div class="mini-block red"></div><div class="mini-block blue"></div><div class="mini-block blue"></div><div class="mini-block green"></div><div class="mini-block green"></div>
                        <!-- Row 7 -->
                        <div class="mini-block yellow"></div><div class="mini-block purple"></div><div class="mini-block orange"></div><div class="mini-block red"></div><div class="mini-block blue"></div><div class="mini-block green"></div>
                        <!-- Row 8 -->
                        <div class="mini-block yellow"></div><div class="mini-block purple"></div><div class="mini-block orange"></div><div class="mini-block yellow"></div><div class="mini-block purple"></div><div class="mini-block orange"></div>
                    </div>
                    <div class="preview-overlay">
                        <div class="play-button">ğŸ®</div>
                        <div class="play-text">í”Œë ˆì´í•˜ê¸°</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Latest Reviews Section -->
    <section class="latest-reviews">
        <div class="section-header">
            <h2>ğŸ“š ìµœì‹  ë¦¬ë·°</h2>
            <p>AIê°€ ë¶„ì„í•œ ì •í™•í•˜ê³  ìœ ìš©í•œ ì œí’ˆ ë¦¬ë·°ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”</p>
        </div>
        <div class="review-grid" id="latest-reviews">
            <!-- ë¡œë”© ìŠ¤í”¼ë„ˆ -->
            <div class="loading-placeholder">
                <div class="spinner"></div>
                <p>ë¦¬ë·°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
            </div>
        </div>
        <div class="text-center">
            <a href="/reviews" class="btn btn-outline">ëª¨ë“  ë¦¬ë·° ë³´ê¸°</a>
        </div>
    </section>

    <!-- Categories Section -->
    <section class="categories">
        <div class="section-header">
            <h2>ğŸ·ï¸ ì¹´í…Œê³ ë¦¬ë³„ ë¦¬ë·°</h2>
            <p>ê´€ì‹¬ ìˆëŠ” ë¶„ì•¼ì˜ ì œí’ˆ ë¦¬ë·°ë¥¼ ì°¾ì•„ë³´ì„¸ìš”</p>
        </div>
        <div class="category-grid">
            <a href="/reviews/category/ì „ìì œí’ˆ" class="category-card electronics">
                <div class="category-background"></div>
                <div class="category-content">
                    <div class="category-icon">ğŸ“±</div>
                    <h3>ì „ìì œí’ˆ</h3>
                    <p>ìŠ¤ë§ˆíŠ¸í°, ë…¸íŠ¸ë¶, ê°€ì „ì œí’ˆ</p>
                    <span class="category-count">12ê°œ ë¦¬ë·°</span>
                </div>
            </a>
            <a href="/reviews/category/ìƒí™œìš©í’ˆ" class="category-card lifestyle">
                <div class="category-background"></div>
                <div class="category-content">
                    <div class="category-icon">ğŸ </div>
                    <h3>ìƒí™œìš©í’ˆ</h3>
                    <p>ì£¼ë°©ìš©í’ˆ, ì²­ì†Œìš©í’ˆ, ì¸í…Œë¦¬ì–´</p>
                    <span class="category-count">8ê°œ ë¦¬ë·°</span>
                </div>
            </a>
            <a href="/reviews/category/íŒ¨ì…˜" class="category-card fashion">
                <div class="category-background"></div>
                <div class="category-content">
                    <div class="category-icon">ğŸ‘•</div>
                    <h3>íŒ¨ì…˜</h3>
                    <p>ì˜ë¥˜, ì‹ ë°œ, ì•¡ì„¸ì„œë¦¬</p>
                    <span class="category-count">6ê°œ ë¦¬ë·°</span>
                </div>
            </a>
            <a href="/reviews/category/ì‹í’ˆ" class="category-card food">
                <div class="category-background"></div>
                <div class="category-content">
                    <div class="category-icon">ğŸ½ï¸</div>
                    <h3>ì‹í’ˆ</h3>
                    <p>ê°„í¸ì‹, ê±´ê°•ì‹í’ˆ, ìŒë£Œ</p>
                    <span class="category-count">4ê°œ ë¦¬ë·°</span>
                </div>
            </a>
        </div>
    </section>

    <!-- AI Features Section -->
    <section class="ai-features">
        <div class="section-header">
            <h2>ğŸ¤– AI ê¸°ë°˜ ìŠ¤ë§ˆíŠ¸ ê¸°ëŠ¥</h2>
            <p>Google Gemini AIê°€ ì œê³µí•˜ëŠ” í˜ì‹ ì ì¸ ì‡¼í•‘ ë„ìš°ë¯¸</p>
        </div>
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">ğŸ¯</div>
                <h3>ë§ì¶¤í˜• ì¶”ì²œ</h3>
                <p>ì‚¬ìš©ì ì·¨í–¥ì— ë§ëŠ” ì œí’ˆì„ AIê°€ ë˜‘ë˜‘í•˜ê²Œ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ“Š</div>
                <h3>ë¦¬ë·° ë¶„ì„</h3>
                <p>ìˆ˜ë§ì€ ë¦¬ë·°ë¥¼ ë¶„ì„í•´ì„œ í•µì‹¬ ì •ë³´ë§Œ ì •ë¦¬í•´ë“œë¦½ë‹ˆë‹¤.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ’°</div>
                <h3>ê°€ê²© ë¹„êµ</h3>
                <p>ë‹¤ì–‘í•œ ì‡¼í•‘ëª°ì˜ ê°€ê²©ì„ ë¹„êµí•´ì„œ ìµœì €ê°€ë¥¼ ì°¾ì•„ë“œë¦½ë‹ˆë‹¤.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ””</div>
                <h3>ì•Œë¦¼ ì„œë¹„ìŠ¤</h3>
                <p>ê´€ì‹¬ ì œí’ˆì˜ í• ì¸ ì •ë³´ì™€ ìƒˆë¡œìš´ ë¦¬ë·°ë¥¼ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.</p>
            </div>
        </div>
    </section>
</div>

<!-- Enhanced CSS -->
<style>
/* PWA Prompt */
.pwa-prompt {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 15px;
    z-index: 1000;
    animation: slideDown 0.3s ease;
}

.pwa-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    max-width: 1200px;
    margin: 0 auto;
}

/* Enhanced Hero Section */
.hero {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 4rem 0;
    margin-bottom: 3rem;
    border-radius: 20px;
    position: relative;
    overflow: hidden;
}

.hero-content {
    display: grid;
    grid-template-columns: 1fr 300px;
    gap: 3rem;
    align-items: center;
}

.hero h1 {
    font-size: 3rem;
    margin-bottom: 0.5rem;
    font-weight: 800;
}

.hero h2 {
    font-size: 1.8rem;
    margin-bottom: 1rem;
    font-weight: 400;
    opacity: 0.9;
}

.hero p {
    font-size: 1.2rem;
    margin-bottom: 2rem;
    opacity: 0.9;
}

.hero-features {
    display: flex;
    gap: 2rem;
    margin-bottom: 2rem;
}

.feature {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 500;
}

.feature-icon {
    font-size: 1.2rem;
}

.hero-buttons {
    display: flex;
    gap: 1rem;
}

.btn-large {
    padding: 1rem 2rem;
    font-size: 1.1rem;
    font-weight: 600;
}

.btn-icon {
    margin-right: 0.5rem;
}

/* Floating Animation */
.floating-elements {
    position: relative;
    height: 200px;
}

.float-item {
    position: absolute;
    font-size: 2rem;
    animation: float 3s ease-in-out infinite;
}

.float-1 { top: 20px; left: 20px; animation-delay: 0s; }
.float-2 { top: 80px; right: 30px; animation-delay: 1s; }
.float-3 { bottom: 60px; left: 50px; animation-delay: 2s; }
.float-4 { bottom: 20px; right: 20px; animation-delay: 0.5s; }

@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-20px); }
}

/* Stats Section */
.stats-section {
    margin: 3rem 0;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 2rem;
}

.stat-card {
    background: white;
    padding: 2rem;
    text-align: center;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    transition: transform 0.3s;
}

.stat-card:hover {
    transform: translateY(-5px);
}

.stat-number {
    font-size: 2.5rem;
    font-weight: 800;
    color: #007bff;
    margin-bottom: 0.5rem;
}

.stat-label {
    color: #666;
    font-weight: 500;
}

/* Game Spotlight */
.game-spotlight {
    background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
    padding: 4rem 0;
    border-radius: 20px;
    margin: 4rem 0;
    color: white;
}

.spotlight-content {
    display: grid;
    grid-template-columns: 1fr 300px;
    gap: 3rem;
    align-items: center;
}

.game-features {
    margin: 2rem 0;
}

.game-feature {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin: 1rem 0;
}

.feature-check {
    color: #4ecdc4;
    font-weight: bold;
}

.btn-game {
    background: rgba(255,255,255,0.2);
    border: 2px solid white;
    color: white;
    backdrop-filter: blur(10px);
}

.btn-game:hover {
    background: white;
    color: #ee5a24;
}

/* Game Preview */
.game-preview-container {
    position: relative;
    width: 250px;
    height: 300px;
    background: #000;
    border-radius: 15px;
    overflow: hidden;
    border: 3px solid rgba(255,255,255,0.3);
}

.tetris-mini-board {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    grid-template-rows: repeat(8, 1fr);
    height: 100%;
    padding: 15px;
    gap: 2px;
}

.mini-block {
    border-radius: 2px;
    background: #2a2a2a;
    opacity: 0.3;
    transition: all 0.3s ease;
}

.mini-block:hover {
    opacity: 0.6;
}

.mini-block.red { background: #ff6b6b; opacity: 0.9; }
.mini-block.blue { background: #4ecdc4; opacity: 0.9; }
.mini-block.green { background: #45b7d1; opacity: 0.9; }
.mini-block.yellow { background: #f9ca24; opacity: 0.9; }
.mini-block.purple { background: #6c5ce7; opacity: 0.9; }
.mini-block.orange { background: #fd79a8; opacity: 0.9; }

.preview-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.7);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s;
}

.game-preview-container:hover .preview-overlay {
    opacity: 1;
}

.play-button {
    font-size: 3rem;
    color: white;
    cursor: pointer;
    margin-bottom: 0.5rem;
}

.play-text {
    color: white;
    font-size: 1rem;
    font-weight: 600;
    text-align: center;
}

/* Enhanced Category Cards */
.category-card {
    position: relative;
    height: 200px;
    border-radius: 15px;
    overflow: hidden;
    transition: all 0.3s;
}

.category-background {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    opacity: 0.1;
    transition: opacity 0.3s;
}

.electronics .category-background { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
.lifestyle .category-background { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
.fashion .category-background { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
.food .category-background { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }

.category-card:hover .category-background {
    opacity: 0.2;
}

.category-content {
    position: relative;
    padding: 2rem;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.category-count {
    background: rgba(0,123,255,0.1);
    color: #007bff;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.875rem;
    font-weight: 500;
    align-self: flex-start;
}

/* AI Features */
.ai-features {
    margin: 4rem 0;
}

.features-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 2rem;
}

.feature-card {
    background: white;
    padding: 2.5rem;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    text-align: center;
    transition: transform 0.3s;
}

.feature-card:hover {
    transform: translateY(-5px);
}

.feature-card .feature-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
}

/* Enhanced Animations */
@keyframes slideDown {
    from { transform: translateY(-100%); }
    to { transform: translateY(0); }
}

/* Loading Placeholder */
.loading-placeholder {
    grid-column: 1 / -1;
    text-align: center;
    padding: 3rem;
}

/* Responsive Design */
@media (max-width: 1024px) {
    .hero-content,
    .spotlight-content {
        grid-template-columns: 1fr;
        text-align: center;
    }
    
    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .features-grid {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 768px) {
    .hero h1 { font-size: 2rem; }
    .hero h2 { font-size: 1.4rem; }
    
    .hero-features {
        flex-direction: column;
        gap: 1rem;
    }
    
    .hero-buttons {
        flex-direction: column;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .category-grid {
        grid-template-columns: 1fr;
    }
}
</style>

<!-- Enhanced JavaScript -->
<script>
// PWA Installation
let deferredPrompt;

window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    document.getElementById('pwa-prompt').style.display = 'block';
});

document.getElementById('pwa-install').addEventListener('click', async () => {
    if (deferredPrompt) {
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        console.log(`PWA ì„¤ì¹˜ ê²°ê³¼: ${outcome}`);
        deferredPrompt = null;
        document.getElementById('pwa-prompt').style.display = 'none';
    }
});

document.getElementById('pwa-dismiss').addEventListener('click', () => {
    document.getElementById('pwa-prompt').style.display = 'none';
});

// Enhanced review loading with error handling
async function loadLatestReviews() {
    try {
        const response = await fetch('/reviews/api?limit=6');
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        const data = await response.json();
        
        const reviewsContainer = document.getElementById('latest-reviews');
        
        if (data.reviews && data.reviews.length > 0) {
            reviewsContainer.innerHTML = data.reviews.map(review => `
                <article class="review-card">
                    <a href="/reviews/${review.slug}">
                        <div class="review-image">
                            <img src="${review.featuredImage || '/images/default-review.svg'}" 
                                 alt="${review.title}"
                                 onerror="this.src='/images/default-review.svg'">
                        </div>
                        <div class="review-content">
                            <span class="review-category">${review.category}</span>
                            <h3>${review.title}</h3>
                            <p>${review.metaDescription || review.content.substring(0, 100)}...</p>
                            <div class="review-meta">
                                <span class="author">by ${review.author?.username || 'ê´€ë¦¬ì'}</span>
                                <span class="date">${new Date(review.publishedAt).toLocaleDateString('ko-KR')}</span>
                            </div>
                        </div>
                    </a>
                </article>
            `).join('');
            
            // Update total reviews count
            document.getElementById('total-reviews').textContent = data.total || data.reviews.length;
        } else {
            reviewsContainer.innerHTML = `
                <div class="no-reviews">
                    <div class="no-reviews-icon">ğŸ“</div>
                    <h3>ì•„ì§ ë¦¬ë·°ê°€ ì—†ìŠµë‹ˆë‹¤</h3>
                    <p>ì²« ë²ˆì§¸ ë¦¬ë·°ë¥¼ ì‘ì„±í•´ë³´ì„¸ìš”!</p>
                    <a href="/admin" class="btn btn-primary">ë¦¬ë·° ì‘ì„±í•˜ê¸°</a>
                </div>
            `;
        }
    } catch (error) {
        console.error('ë¦¬ë·° ë¡œë“œ ì‹¤íŒ¨:', error);
        const reviewsContainer = document.getElementById('latest-reviews');
        reviewsContainer.innerHTML = `
            <div class="error-message">
                <div class="error-icon">ğŸ˜…</div>
                <h3>ë¦¬ë·°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h3>
                <p>ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>
                <button onclick="loadLatestReviews()" class="btn btn-primary">ë‹¤ì‹œ ì‹œë„</button>
            </div>
        `;
    }
}

// Counter animation
function animateCounters() {
    const counters = document.querySelectorAll('.stat-number');
    counters.forEach(counter => {
        const target = parseInt(counter.textContent);
        if (isNaN(target)) return;
        
        let current = 0;
        const increment = target / 50;
        const timer = setInterval(() => {
            current += increment;
            if (current >= target) {
                counter.textContent = target.toLocaleString();
                clearInterval(timer);
            } else {
                counter.textContent = Math.floor(current).toLocaleString();
            }
        }, 30);
    });
}

// Page load events
document.addEventListener('DOMContentLoaded', () => {
    loadLatestReviews();
    
    // Intersection Observer for animations
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                if (entry.target.classList.contains('stats-section')) {
                    animateCounters();
                }
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    });
    
    // Observe sections for scroll animations
    document.querySelectorAll('section').forEach(section => {
        section.style.opacity = '0';
        section.style.transform = 'translateY(20px)';
        section.style.transition = 'opacity 0.6s, transform 0.6s';
        observer.observe(section);
    });
});

// Service Worker registration
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js')
        .then(() => console.log('SW registered'))
        .catch(() => console.log('SW registration failed'));
}
</script>

<!-- Enhanced Main Page Script -->
<script src="/js/main.js"></script>

<%- include('footer') %>
